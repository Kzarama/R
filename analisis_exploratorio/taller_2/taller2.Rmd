---
title: "Taller en clase #2"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}
library(flexdashboard)
library("readxl")
library(knitr)
library(rmarkdown)
library(ggplot2)
library(scales)
library(ggthemes)

library(corrplot)
library(directlabels)
library(grid)
library(gridExtra)
library(stats)
library(readxl)
library(reshape2)
library(dplyr)
library(e1071)
library(Hmisc)

setwd(".")
```

Carga de datos
===

#### Diccionario

Contexto:

Pertenecen a un grupo de investigación del Icfes. Se les ha asignado la tarea de revisar investigaciones sobre los factores de éxito en el desempeño en un curso de matemáticas de estudiantes de bachillerato. Para iniciar con la investigación, se les entregaron los datos de un colegio que hizo seguimiento a 357 estudiantes de grado 10mo durante el último año lectivo. Recopilaron la nota en dicha asignatura, así como también otras variables importantes sobre el individuo y su hogar.

A continuación se presenta el diccionario de variables:

- sex - student's sex (binary: "F" - female or "M" - male)

- age - student's age (numeric: from 15 to 22)

- address - student's home address type (binary: "U" - urban or "R" - rural)

- Pstatus - parent's cohabitation status (binary: "T" - living together or "A" - apart)

- Medu - mother's education (numeric: 1 - none or primary education (4th grade), 2 – 5th to 9th grade, 3 – secondary education or 4 – higher education)

- Fedu - father's education (numeric: 1 - none or primary education (4th grade), 2 – 5th to 9th grade, 3 – secondary education or 4 – higher education)

- reason - reason to choose this school (nominal: close to "home", school "reputation", "course" preference or "other")

- traveltime - home to school travel time (numeric: 1 - <15 min., 2 - 15 to 30 min., 3 - >30 min.)

- paid - extra paid classes within the course subject (Math) (binary: yes or no)

- internet - Internet access at home (binary: yes or no)

- absences - number of school absences (numeric: 1 - 0 to 5 absences, 2 - 6 to 10 absences, 3 - 11 to 20 absences, >20 absences)

- G3 - final grade (numeric: from 0 to 20, output target)

#### Carga de datos 

Carga del conjunto de datos de desempeño en el curso de matematicas de estudiantes de bachillerato.

```{r}
performance_data <- get(load("performance.RDATA"))
paged_table(performance_data)
```

#### Tipos variables en el conjuto de datos

Presentación de el tipo de dato para cada variable del conjunto de datos.

```{r}
str(performance_data)
```

```{r}
tabla_freq <- function(x,total=1,na="ifany"){
  if (total==1) {
    M=data.frame("Categoría"=table(x, useNA = na), "Rel"=prop.table(table(x,useNA = na)))[,-3]
  names(M)=c("Categoría","Freq. Abs.","Freq. Rel.")
  M$Categoría=as.character(M$Categoría)
  M[nrow(M)+1,]=c("Total",sum(M$`Freq. Abs.`),sum(M$`Freq. Rel.`))
  M$`Freq. Rel.`=as.numeric(M$`Freq. Rel.`)
  M$`Freq. Abs.`=as.numeric(M$`Freq. Abs.`)
  M
  } else{
    M=data.frame("Categoría"=table(x, useNA = na), "Rel"=prop.table(table(x,useNA = na)))[,-3]
    names(M)=c("Categoría","Freq. Abs.","Freq. Rel.")
    M
  }
}
```


Análisis univariado
===

```{r}
TABLA=tabla_freq(performance_data$sex, 0)

ggplot(TABLA, aes(x=Categoría, y=`Freq. Rel.`))+
  geom_bar(stat = "identity", fill="steelblue", color="black")+
  labs(x="Género",y="Frecuencia")+
  scale_y_continuous(limits = c(0,ifelse(max(TABLA$`Freq. Rel.`)>0.5,1,0.5)), breaks = seq(0,ifelse(max(TABLA$`Freq. Rel.`)>0.5,1,0.5),0.1), labels = percent)+
  geom_text(aes(x=Categoría, y=`Freq. Rel.`, label=percent(`Freq. Rel.`)),vjust=-0.5, fontface = "bold", size=5)+
  theme_base()
```

```{r}
TABLA = tabla_freq(performance_data$age, 0)

ggplot(TABLA, aes(x=Categoría, y=`Freq. Rel.`))+
  geom_bar(stat = "identity", fill="steelblue", color="black")+
  labs(x="Nivel de ingreso",y="Frecuencia")+
  scale_y_continuous(limits = c(0,ifelse(max(TABLA$`Freq. Rel.`)>0.5,1,0.5)), breaks = seq(0,ifelse(max(TABLA$`Freq. Rel.`)>0.5,1,0.5),0.1), labels = percent)+
  geom_text(aes(x=Categoría, y=`Freq. Rel.`, label=percent(`Freq. Rel.`)),vjust=-0.5, fontface = "bold", size=5)+
  theme_base()
```

```{r}
TABLA = tabla_freq(performance_data$address, 0)

ggplot(TABLA, aes(x=Categoría, y=`Freq. Rel.`))+
  geom_bar(stat = "identity", fill="steelblue", color="black")+
  labs(x="Nivel de ingreso",y="Frecuencia")+
  scale_y_continuous(limits = c(0,ifelse(max(TABLA$`Freq. Rel.`)>0.5,1,0.5)), breaks = seq(0,ifelse(max(TABLA$`Freq. Rel.`)>0.5,1,0.5),0.1), labels = percent)+
  geom_text(aes(x=Categoría, y=`Freq. Rel.`, label=percent(`Freq. Rel.`)),vjust=-0.5, fontface = "bold", size=5)+
  theme_base()
```

```{r}
TABLA = tabla_freq(performance_data$Pstatus, 0)

ggplot(TABLA, aes(x=Categoría, y=`Freq. Rel.`))+
  geom_bar(stat = "identity", fill="steelblue", color="black")+
  labs(x="Nivel de ingreso",y="Frecuencia")+
  scale_y_continuous(limits = c(0,ifelse(max(TABLA$`Freq. Rel.`)>0.5,1,0.5)), breaks = seq(0,ifelse(max(TABLA$`Freq. Rel.`)>0.5,1,0.5),0.1), labels = percent)+
  geom_text(aes(x=Categoría, y=`Freq. Rel.`, label=percent(`Freq. Rel.`)),vjust=-0.5, fontface = "bold", size=5)+
  theme_base()
```

```{r}
TABLA = tabla_freq(performance_data$Medu, 0)

ggplot(TABLA, aes(x=Categoría, y=`Freq. Rel.`))+
  geom_bar(stat = "identity", fill="steelblue", color="black")+
  labs(x="Nivel de ingreso",y="Frecuencia")+
  scale_y_continuous(limits = c(0,ifelse(max(TABLA$`Freq. Rel.`)>0.5,1,0.5)), breaks = seq(0,ifelse(max(TABLA$`Freq. Rel.`)>0.5,1,0.5),0.1), labels = percent)+
  geom_text(aes(x=Categoría, y=`Freq. Rel.`, label=percent(`Freq. Rel.`)),vjust=-0.5, fontface = "bold", size=5)+
  theme_base()
```

```{r}
TABLA = tabla_freq(performance_data$Fedu, 0)

ggplot(TABLA, aes(x=Categoría, y=`Freq. Rel.`))+
  geom_bar(stat = "identity", fill="steelblue", color="black")+
  labs(x="Nivel de ingreso",y="Frecuencia")+
  scale_y_continuous(limits = c(0,ifelse(max(TABLA$`Freq. Rel.`)>0.5,1,0.5)), breaks = seq(0,ifelse(max(TABLA$`Freq. Rel.`)>0.5,1,0.5),0.1), labels = percent)+
  geom_text(aes(x=Categoría, y=`Freq. Rel.`, label=percent(`Freq. Rel.`)),vjust=-0.5, fontface = "bold", size=5)+
  theme_base()
```

```{r}
TABLA = tabla_freq(performance_data$reason, 0)

ggplot(TABLA, aes(x=Categoría, y=`Freq. Rel.`))+
  geom_bar(stat = "identity", fill="steelblue", color="black")+
  labs(x="Nivel de ingreso",y="Frecuencia")+
  scale_y_continuous(limits = c(0,ifelse(max(TABLA$`Freq. Rel.`)>0.5,1,0.5)), breaks = seq(0,ifelse(max(TABLA$`Freq. Rel.`)>0.5,1,0.5),0.1), labels = percent)+
  geom_text(aes(x=Categoría, y=`Freq. Rel.`, label=percent(`Freq. Rel.`)),vjust=-0.5, fontface = "bold", size=5)+
  theme_base()
```

```{r}
TABLA = tabla_freq(performance_data$traveltime, 0)

ggplot(TABLA, aes(x=Categoría, y=`Freq. Rel.`))+
  geom_bar(stat = "identity", fill="steelblue", color="black")+
  labs(x="Nivel de ingreso",y="Frecuencia")+
  scale_y_continuous(limits = c(0,ifelse(max(TABLA$`Freq. Rel.`)>0.5,1,0.5)), breaks = seq(0,ifelse(max(TABLA$`Freq. Rel.`)>0.5,1,0.5),0.1), labels = percent)+
  geom_text(aes(x=Categoría, y=`Freq. Rel.`, label=percent(`Freq. Rel.`)),vjust=-0.5, fontface = "bold", size=5)+
  theme_base()
```

```{r}
TABLA = tabla_freq(performance_data$paid, 0)

ggplot(TABLA, aes(x=Categoría, y=`Freq. Rel.`))+
  geom_bar(stat = "identity", fill="steelblue", color="black")+
  labs(x="Nivel de ingreso",y="Frecuencia")+
  scale_y_continuous(limits = c(0,ifelse(max(TABLA$`Freq. Rel.`)>0.5,1,0.5)), breaks = seq(0,ifelse(max(TABLA$`Freq. Rel.`)>0.5,1,0.5),0.1), labels = percent)+
  geom_text(aes(x=Categoría, y=`Freq. Rel.`, label=percent(`Freq. Rel.`)),vjust=-0.5, fontface = "bold", size=5)+
  theme_base()
```

```{r}
TABLA = tabla_freq(performance_data$internet, 0)

ggplot(TABLA, aes(x=Categoría, y=`Freq. Rel.`))+
  geom_bar(stat = "identity", fill="steelblue", color="black")+
  labs(x="Nivel de ingreso",y="Frecuencia")+
  scale_y_continuous(limits = c(0,ifelse(max(TABLA$`Freq. Rel.`)>0.5,1,0.5)), breaks = seq(0,ifelse(max(TABLA$`Freq. Rel.`)>0.5,1,0.5),0.1), labels = percent)+
  geom_text(aes(x=Categoría, y=`Freq. Rel.`, label=percent(`Freq. Rel.`)),vjust=-0.5, fontface = "bold", size=5)+
  theme_base()
```

```{r}
TABLA = tabla_freq(performance_data$absences, 0)

ggplot(TABLA, aes(x=Categoría, y=`Freq. Rel.`))+
  geom_bar(stat = "identity", fill="steelblue", color="black")+
  labs(x="Nivel de ingreso",y="Frecuencia")+
  scale_y_continuous(limits = c(0,ifelse(max(TABLA$`Freq. Rel.`)>0.5,1,0.5)), breaks = seq(0,ifelse(max(TABLA$`Freq. Rel.`)>0.5,1,0.5),0.1), labels = percent)+
  geom_text(aes(x=Categoría, y=`Freq. Rel.`, label=percent(`Freq. Rel.`)),vjust=-0.5, fontface = "bold", size=5)+
  theme_base()
```

```{r}
TABLA = tabla_freq(performance_data$G3, 0)

ggplot(TABLA, aes(x=Categoría, y=`Freq. Rel.`))+
  geom_bar(stat = "identity", fill="steelblue", color="black")+
  labs(x="Nivel de ingreso",y="Frecuencia")+
  scale_y_continuous(limits = c(0,ifelse(max(TABLA$`Freq. Rel.`)>0.5,1,0.5)), breaks = seq(0,ifelse(max(TABLA$`Freq. Rel.`)>0.5,1,0.5),0.1), labels = percent)+
  geom_text(aes(x=Categoría, y=`Freq. Rel.`, label=percent(`Freq. Rel.`)),vjust=-0.5, fontface = "bold", size=5)+
  theme_base()
```

Análisis bivariado
===



Conclusiones
===


